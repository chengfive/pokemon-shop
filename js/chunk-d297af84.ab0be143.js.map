{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.from.js","webpack:///./src/views/CheckOrder.vue","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","webpack:///./src/views/CheckOrder.vue?5c16"],"names":["$","from","checkCorrectnessOfIteration","INCORRECT_ITERATION","iterable","Array","target","stat","forced","class","colspan","style","isLoading","temporaryCart","length","cart","discount","temporaryDiscount","selectPrice","user","order","name","email","phone","address","remark","paid","isPaid","pay","_arrayLikeToArray","arr","len","i","arr2","_unsupportedIterableToArray","o","minLen","arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","test","_createForOfIteratorHelper","allowArrayLike","it","Symbol","iterator","isArray","unsupportedIterableToArray","F","s","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","data","checkPass","price","Number","components","computed","this","amount","methods","store","commit","a","get","id","then","response","element","product","products","find","item","newArr","filter","totalQuantity","reduce","accumulator","currentValue","quantity","patch","post","dispatch","alert","render"],"mappings":"mGAAA,IAAIA,EAAI,EAAQ,QACZC,EAAO,EAAQ,QACfC,EAA8B,EAAQ,QAEtCC,GAAuBD,GAA4B,SAAUE,GAE/DC,MAAMJ,KAAKG,MAKbJ,EAAE,CAAEM,OAAQ,QAASC,MAAM,EAAMC,OAAQL,GAAuB,CAC9DF,KAAMA,K,sECXkBQ,MAAM,gB,GACNA,MAAM,W,GACDA,MAAM,gB,SACDA,MAAM,c,SAC5BA,MAAM,c,GAMTA,MAAM,e,EACX,eAEK,WADH,eAAyB,MAArBC,QAAQ,KAAI,U,KAGhB,eAAW,UAAP,MAAE,G,EAIN,eAAe,UAAX,UAAM,G,EAIV,eAAa,UAAT,QAAI,G,EAIR,eAAa,UAAT,QAAI,G,EAIR,eAAW,UAAP,MAAE,G,EAIN,eAAa,UAAT,QAAI,G,GACJC,MAAA,mB,SAGYF,MAAM,O,EAI5B,eAA6B,OAAxBA,MAAM,aAAW,S,wHA3CtB,eAA+C,MAA/C,EAA+C,W,QAAlC,EAAAG,a,eACb,eAA0C,MAA1C,EAA0C,W,QAA7B,EAAAA,a,eACb,eAAoD,MAApD,EAAoD,W,SAAtC,EAAAC,iBACF,EAAAA,cAAcC,Q,iBAC1B,eAsCM,MAtCN,EAsCM,CArCJ,eAIE,GAHCC,KAAM,EAAAF,cACNG,SAAU,EAAAC,kBACV,cAAa,EAAAC,a,4CAEhB,eA4BQ,QA5BR,EA4BQ,CA3BN,EAGA,eAGK,WAFH,EACA,eAA8B,yBAAvB,EAAAC,KAAKC,MAAMC,MAAI,KAExB,eAGK,WAFH,EACA,eAA+B,yBAAxB,EAAAF,KAAKC,MAAME,OAAK,KAEzB,eAGK,WAFH,EACA,eAA+B,yBAAxB,EAAAH,KAAKC,MAAMG,OAAK,KAEzB,eAGK,WAFH,EACA,eAAiC,yBAA1B,EAAAJ,KAAKC,MAAMI,SAAO,KAE3B,eAGK,WAFH,EACA,eAAgC,yBAAzB,EAAAL,KAAKC,MAAMK,QAAM,KAE1B,eAGK,WAFH,EACA,eAA0C,KAA1C,EAA0C,eAAZ,EAAAC,MAAI,OAG1B,EAAAC,O,wCAAZ,eAEM,MAFN,EAEM,CADJ,eAAkC,UAAzB,QAAK,8BAAE,EAAAC,KAAA,EAAAA,IAAA,sBAAK,e,iBArCzB,eAAiE,MAAjE,EAAqD,WAwCrD,G,oFC5Ca,SAASC,EAAkBC,EAAKC,IAClC,MAAPA,GAAeA,EAAMD,EAAIhB,UAAQiB,EAAMD,EAAIhB,QAE/C,IAAK,IAAIkB,EAAI,EAAGC,EAAO,IAAI5B,MAAM0B,GAAMC,EAAID,EAAKC,IAC9CC,EAAKD,GAAKF,EAAIE,GAGhB,OAAOC,ECNM,SAASC,EAA4BC,EAAGC,GACrD,GAAKD,EAAL,CACA,GAAiB,kBAANA,EAAgB,OAAOE,EAAiBF,EAAGC,GACtD,IAAIE,EAAIC,OAAOC,UAAUC,SAASC,KAAKP,GAAGQ,MAAM,GAAI,GAEpD,MADU,WAANL,GAAkBH,EAAES,cAAaN,EAAIH,EAAES,YAAYvB,MAC7C,QAANiB,GAAqB,QAANA,EAAoBjC,MAAMJ,KAAKkC,GACxC,cAANG,GAAqB,2CAA2CO,KAAKP,GAAWD,EAAiBF,EAAGC,QAAxG,GCNa,SAASU,EAA2BX,EAAGY,GACpD,IAAIC,EAAuB,qBAAXC,QAA0Bd,EAAEc,OAAOC,WAAaf,EAAE,cAElE,IAAKa,EAAI,CACP,GAAI3C,MAAM8C,QAAQhB,KAAOa,EAAKI,EAA2BjB,KAAOY,GAAkBZ,GAAyB,kBAAbA,EAAErB,OAAqB,CAC/GkC,IAAIb,EAAIa,GACZ,IAAIhB,EAAI,EAEJqB,EAAI,aAER,MAAO,CACLC,EAAGD,EACHf,EAAG,WACD,OAAIN,GAAKG,EAAErB,OAAe,CACxByC,MAAM,GAED,CACLA,MAAM,EACNC,MAAOrB,EAAEH,OAGbyB,EAAG,SAAWC,GACZ,MAAMA,GAERC,EAAGN,GAIP,MAAM,IAAIO,UAAU,yIAGtB,IAEIC,EAFAC,GAAmB,EACnBC,GAAS,EAEb,MAAO,CACLT,EAAG,WACDN,EAAKA,EAAGN,KAAKP,IAEfG,EAAG,WACD,IAAI0B,EAAOhB,EAAGiB,OAEd,OADAH,EAAmBE,EAAKT,KACjBS,GAETP,EAAG,SAAWS,GACZH,GAAS,EACTF,EAAMK,GAERP,EAAG,WACD,IACOG,GAAoC,MAAhBd,EAAG,WAAmBA,EAAG,YADpD,QAGE,GAAIe,EAAQ,MAAMF,K,+HHEX,GACbM,KADa,WAEX,MAAO,CACLxC,QAAQ,EACRyC,WAAW,EACXC,MAAOC,SAGXC,WAAY,CACVxD,KAAA,QAEFyD,SAAU,iCACL,eAAS,CACV,gBACA,YACA,OACA,WACA,uBANI,IAQN9C,KARQ,WASN,OAAoB,IAAhB+C,KAAK9C,OACA,OAEA,OAGXP,MAfQ,WAgBN,MAAO,CACLC,KAAMoD,KAAKtD,KAAKC,MAAMC,KACtBC,MAAOmD,KAAKtD,KAAKC,MAAME,MACvBC,MAAOkD,KAAKtD,KAAKC,MAAMG,MACvBC,QAASiD,KAAKtD,KAAKC,MAAMI,QACzBC,OAAQgD,KAAKtD,KAAKC,MAAMK,OACxBiD,OAAQD,KAAKJ,UAInBM,QAAS,CACPzD,YADO,SACKmD,GACVI,KAAKJ,MAAQA,GAETzC,IAJC,WAIK,+JACVgD,EAAA,KAAMC,OAAO,WAAW,GADd,SAEJ,EAAAC,EACHC,IAAI,mDAAqD,EAAK5D,KAAK6D,IACnEC,KAFG,yDAEE,WAAOC,GAAP,iGACgBA,EAASf,KAAKpD,MAD9B,0BACKoE,EADL,QAEEC,EAAU,EAAKC,SAASC,MAAK,SAACC,GAAD,OAAUA,EAAKP,KAAOG,EAAQH,MAC3DQ,EAASN,EAASf,KAAKpD,KAAK0E,QAC9B,SAACF,GAAD,OAAUA,EAAKP,KAAOI,EAAQJ,MAG5BU,EAAgBF,EAAOG,QACzB,SAACC,EAAaC,GAAd,OACED,EAAcC,EAAaC,WAC7B,GAEF,GAAIJ,EAAgBN,EAAQU,SAG1B,OAFA,EAAK1B,WAAY,EACjBQ,EAAA,KAAMC,OAAO,WAAW,GACxB,QAEA,EAAKT,WAAY,GAjBjB,0TAFF,uDAFI,WA0BN,EAAKA,UA1BC,iCA2BF,EAAAU,EACHC,IACC,mDAAqD,EAAK5D,KAAK6D,IAEhEC,KAJG,yDAIE,WAAOC,GAAP,+FACgBA,EAASf,KAAKpD,MAD9B,iJACKoE,EADL,QAEEC,EAAU,EAAKC,SAASC,MAC1B,SAACC,GAAD,OAAUA,EAAKP,KAAOG,EAAQH,MAH9B,SAMI,EAAAF,EAAMiB,MACV,sDACEX,EAAQJ,GACV,CACEc,SAAUV,EAAQU,SAAWX,EAAQW,WAVvC,uBAaI,EAAAhB,EACHC,IAAI,sDACJE,MAAK,SAACC,GACLN,EAAA,KAAMC,OAAO,cAAeK,EAASf,SAhBvC,oUAJF,uDA3BE,uBAmDF,EAAAW,EAAMkB,KACV,mDACA,EAAK5E,OArDC,wBAuDF,EAAA0D,EAAMiB,MACV,mDAAqD,EAAK5E,KAAK6D,GAC/D,CACEjE,KAAM,KA1DF,QA6DR,EAAKY,QAAS,EACdiD,EAAA,KAAMqB,SAAS,WACfrB,EAAA,KAAMC,OAAO,cAAe,GAC5BD,EAAA,KAAMC,OAAO,WAAW,GAhEhB,wBAkERqB,MAAM,YAlEE,iDI5FhB,EAAOC,OAASA,EAED","file":"js/chunk-d297af84.ab0be143.js","sourcesContent":["var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  // eslint-disable-next-line es/no-array-from -- required for testing\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.es/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","<template>\n  <div v-show=\"isLoading\" class=\"loading-icon\" />\n  <div v-show=\"isLoading\" class=\"overlay\" />\n  <div v-show=\"!temporaryCart\" class=\"loading-icon\" />\n  <div v-if=\"!temporaryCart.length\" class=\"cart-empty\">購物車是空的</div>\n  <div v-else class=\"check-page\">\n    <cart\n      :cart=\"temporaryCart\"\n      :discount=\"temporaryDiscount\"\n      @selectPrice=\"selectPrice\"\n    />\n    <table class=\"check-table\">\n      <tr>\n        <td colspan=\"2\">訂單資訊</td>\n      </tr>\n      <tr>\n        <td>姓名</td>\n        <td>{{ user.order.name }}</td>\n      </tr>\n      <tr>\n        <td>電子郵件地址</td>\n        <td>{{ user.order.email }}</td>\n      </tr>\n      <tr>\n        <td>手機號碼</td>\n        <td>{{ user.order.phone }}</td>\n      </tr>\n      <tr>\n        <td>居住地址</td>\n        <td>{{ user.order.address }}</td>\n      </tr>\n      <tr>\n        <td>備註</td>\n        <td>{{ user.order.remark }}</td>\n      </tr>\n      <tr>\n        <td>付款狀態</td>\n        <td style=\"color: #ff0000\">{{ paid }}</td>\n      </tr>\n    </table>\n    <div v-if=\"!isPaid\" class=\"pay\">\n      <button @click=\"pay\">確認付款</button>\n    </div>\n  </div>\n  <div class=\"pop-check\"></div>\n</template>\n\n<script>\nimport cart from \"@/components/Cart.vue\";\nimport store from \"@/store/index.js\";\nimport axios from \"axios\";\n\nimport { mapState } from \"vuex\";\n\nexport default {\n  data() {\n    return {\n      isPaid: false,\n      checkPass: false,\n      price: Number,\n    };\n  },\n  components: {\n    cart,\n  },\n  computed: {\n    ...mapState([\n      \"temporaryCart\",\n      \"isLoading\",\n      \"user\",\n      \"products\",\n      \"temporaryDiscount\",\n    ]),\n    paid() {\n      if (this.isPaid !== true) {\n        return \"尚未付款\";\n      } else {\n        return \"已付款\";\n      }\n    },\n    order() {\n      return {\n        name: this.user.order.name,\n        email: this.user.order.email,\n        phone: this.user.order.phone,\n        address: this.user.order.address,\n        remark: this.user.order.remark,\n        amount: this.price,\n      };\n    },\n  },\n  methods: {\n    selectPrice(price) {\n      this.price = price;\n    },\n    async pay() {\n      store.commit(\"loading\", true);\n      await axios\n        .get(\"https://pokemon-shop-server.herokuapp.com/users/\" + this.user.id)\n        .then(async (response) => {\n          for (let element of response.data.cart) {\n            let product = this.products.find((item) => item.id === element.id);\n            let newArr = response.data.cart.filter(\n              (item) => item.id === product.id\n            );\n\n            let totalQuantity = newArr.reduce(\n              (accumulator, currentValue) =>\n                accumulator + currentValue.quantity,\n              0\n            );\n            if (totalQuantity > product.quantity) {\n              this.checkPass = false;\n              store.commit(\"loading\", false);\n              break;\n            } else {\n              this.checkPass = true;\n            }\n          }\n        });\n\n      if (this.checkPass) {\n        await axios\n          .get(\n            \"https://pokemon-shop-server.herokuapp.com/users/\" + this.user.id\n          )\n          .then(async (response) => {\n            for (let element of response.data.cart) {\n              let product = this.products.find(\n                (item) => item.id === element.id\n              );\n\n              await axios.patch(\n                \"https://pokemon-shop-server.herokuapp.com/products/\" +\n                  product.id,\n                {\n                  quantity: product.quantity - element.quantity,\n                }\n              );\n              await axios\n                .get(\"https://pokemon-shop-server.herokuapp.com/products\")\n                .then((response) => {\n                  store.commit(\"addProducts\", response.data);\n                });\n            }\n          });\n        await axios.post(\n          \"https://pokemon-shop-server.herokuapp.com/orders\",\n          this.order\n        );\n        await axios.patch(\n          \"https://pokemon-shop-server.herokuapp.com/users/\" + this.user.id,\n          {\n            cart: [],\n          }\n        );\n        this.isPaid = true;\n        store.dispatch(\"getUser\");\n        store.commit(\"addDiscount\", 1);\n        store.commit(\"loading\", false);\n      } else {\n        alert(\"商品超出購買上限\");\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\"></style>\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import { render } from \"./CheckOrder.vue?vue&type=template&id=52a55002\"\nimport script from \"./CheckOrder.vue?vue&type=script&lang=js\"\nexport * from \"./CheckOrder.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}