(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d297af84"],{a630:function(e,t,r){var n=r("23e7"),a=r("4df4"),c=r("1c7e"),o=!c((function(e){Array.from(e)}));n({target:"Array",stat:!0,forced:o},{from:a})},a92a:function(e,t,r){"use strict";r.r(t);r("b0c0");var n=r("7a23"),a={class:"loading-icon"},c={class:"overlay"},o={class:"loading-icon"},u={key:0,class:"cart-empty"},i={key:1,class:"check-page"},s={class:"check-table"},d=Object(n["g"])("tr",null,[Object(n["g"])("td",{colspan:"2"},"訂單資訊")],-1),l=Object(n["g"])("td",null,"姓名",-1),p=Object(n["g"])("td",null,"電子郵件地址",-1),b=Object(n["g"])("td",null,"手機號碼",-1),f=Object(n["g"])("td",null,"居住地址",-1),h=Object(n["g"])("td",null,"備註",-1),m=Object(n["g"])("td",null,"付款狀態",-1),g={style:{color:"#ff0000"}},j={key:0,class:"pay"},O=Object(n["g"])("div",{class:"pop-check"},null,-1);function v(e,t,r,v,k,y){var x=Object(n["u"])("cart");return Object(n["p"])(),Object(n["d"])(n["a"],null,[Object(n["D"])(Object(n["g"])("div",a,null,512),[[n["A"],e.isLoading]]),Object(n["D"])(Object(n["g"])("div",c,null,512),[[n["A"],e.isLoading]]),Object(n["D"])(Object(n["g"])("div",o,null,512),[[n["A"],!e.temporaryCart]]),e.temporaryCart.length?(Object(n["p"])(),Object(n["d"])("div",i,[Object(n["g"])(x,{cart:e.temporaryCart,discount:e.temporaryDiscount,onSelectPrice:y.selectPrice},null,8,["cart","discount","onSelectPrice"]),Object(n["g"])("table",s,[d,Object(n["g"])("tr",null,[l,Object(n["g"])("td",null,Object(n["x"])(e.user.order.name),1)]),Object(n["g"])("tr",null,[p,Object(n["g"])("td",null,Object(n["x"])(e.user.order.email),1)]),Object(n["g"])("tr",null,[b,Object(n["g"])("td",null,Object(n["x"])(e.user.order.phone),1)]),Object(n["g"])("tr",null,[f,Object(n["g"])("td",null,Object(n["x"])(e.user.order.address),1)]),Object(n["g"])("tr",null,[h,Object(n["g"])("td",null,Object(n["x"])(e.user.order.remark),1)]),Object(n["g"])("tr",null,[m,Object(n["g"])("td",g,Object(n["x"])(y.paid),1)])]),k.isPaid?Object(n["e"])("",!0):(Object(n["p"])(),Object(n["d"])("div",j,[Object(n["g"])("button",{onClick:t[1]||(t[1]=function(){return y.pay&&y.pay.apply(y,arguments)})},"確認付款")]))])):(Object(n["p"])(),Object(n["d"])("div",u,"購物車是空的")),O],64)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("fb6a"),r("a630");function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){if(e){if("string"===typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}function x(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,c=e},f:function(){try{o||null==r["return"]||r["return"]()}finally{if(u)throw c}}}}var w=r("1da1"),P=r("5530"),A=(r("96cf"),r("a9e3"),r("7db0"),r("4de4"),r("b3b1")),R=r("4360"),S=r("8206"),C=r.n(S),D=r("5502"),q={data:function(){return{isPaid:!1,checkPass:!1,price:Number}},components:{cart:A["a"]},computed:Object(P["a"])(Object(P["a"])({},Object(D["b"])(["temporaryCart","isLoading","user","products","temporaryDiscount"])),{},{paid:function(){return!0!==this.isPaid?"尚未付款":"已付款"},order:function(){return{name:this.user.order.name,email:this.user.order.email,phone:this.user.order.phone,address:this.user.order.address,remark:this.user.order.remark,amount:this.price}}}),methods:{selectPrice:function(e){this.price=e},pay:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return R["a"].commit("loading",!0),t.next=3,C.a.get("https://pokemon-shop-server.herokuapp.com/users/"+e.user.id).then(function(){var t=Object(w["a"])(regeneratorRuntime.mark((function t(r){var n,a,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=x(r.data.cart),t.prev=1,c=function(){var t=a.value,n=e.products.find((function(e){return e.id===t.id})),c=r.data.cart.filter((function(e){return e.id===n.id})),o=c.reduce((function(e,t){return e+t.quantity}),0);if(o>n.quantity)return e.checkPass=!1,R["a"].commit("loading",!1),"break";e.checkPass=!0},n.s();case 4:if((a=n.n()).done){t.next=10;break}if(o=c(),"break"!==o){t.next=8;break}return t.abrupt("break",10);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,12,15,18]])})));return function(e){return t.apply(this,arguments)}}());case 3:if(!e.checkPass){t.next=16;break}return t.next=6,C.a.get("https://pokemon-shop-server.herokuapp.com/users/"+e.user.id).then(function(){var t=Object(w["a"])(regeneratorRuntime.mark((function t(r){var n,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=x(r.data.cart),t.prev=1,c=regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.value,n=e.products.find((function(e){return e.id===r.id})),t.next=4,C.a.patch("https://pokemon-shop-server.herokuapp.com/products/"+n.id,{quantity:n.quantity-r.quantity});case 4:return t.next=6,C.a.get("https://pokemon-shop-server.herokuapp.com/products").then((function(e){R["a"].commit("addProducts",e.data)}));case 6:case"end":return t.stop()}}),t)})),n.s();case 4:if((a=n.n()).done){t.next=8;break}return t.delegateYield(c(),"t0",6);case 6:t.next=4;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t["catch"](1),n.e(t.t1);case 13:return t.prev=13,n.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})));return function(e){return t.apply(this,arguments)}}());case 6:return t.next=8,C.a.post("https://pokemon-shop-server.herokuapp.com/orders",e.order);case 8:return t.next=10,C.a.patch("https://pokemon-shop-server.herokuapp.com/users/"+e.user.id,{cart:[]});case 10:e.isPaid=!0,R["a"].dispatch("getUser"),R["a"].commit("addDiscount",1),R["a"].commit("loading",!1),t.next=17;break;case 16:alert("商品超出購買上限");case 17:case"end":return t.stop()}}),t)})))()}}};q.render=v;t["default"]=q}}]);
//# sourceMappingURL=chunk-d297af84.ab0be143.js.map